(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ad21030"],{"3e38":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("h2",[t._v("鼠标拖动任务")]),e("Task")],1)},r=[],i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"u-task"},[e("div",{attrs:{id:"app"},on:{mousemove:function(s){return t.onDrag(s)},mouseup:function(s){return t.onDragStop()}}},[e("main",t._l(t.filledPanes,(function(s,a){return e("div",{key:a,ref:"pane-"+a,refInFor:!0,staticClass:"pane"},[e("div",{staticClass:"pane-header"},[t._v(t._s(s.name))]),t._l(s.cards,(function(s,a){return e("div",{key:a,ref:"card-"+s.index,refInFor:!0,class:{"pane-card":!0,dragging:t.draggedCardIdx===s.index},on:{mousedown:function(e){return t.onDragStart(e,s.index)}}},[t._v(" "+t._s(s.name)+" ")])}))],2)})),0),e("div",{ref:"ghostCard",class:{"pane-card":!0,active:-1!==t.draggedCardIdx,leaving:t.ghostCardStyle.leaving,animate:t.settings.animate},style:"\n             width: "+t.ghostCardStyle.width+"px;\n             left: "+t.ghostCardStyle.pos.x+"px; top: "+(t.ghostCardStyle.pos.y-10)+"px;\n             transform: "+t.ghostCardStyle.transform+";\n             transform-origin: "+t.ghostCardStyle.transformOrigin+";\n             ",attrs:{id:"ghost-card"}},[t._v(" "+t._s(t.draggedCard.name)+" ")])])])},n=[];const d={trelloStyle:!1,animateEnd:!0,transformOriginMode:"mouse",scale:1.1,rotationOffset:{min:1.2,max:2},rotationMitigation:.2,debug:{dataInspector:!1}};var o={name:"index",data:function(){return{mousePos:{x:-1e3,y:-1e3},lastMousePos:{x:0,y:0},draggedCardIdx:-1,paneOverlappedIdx:-1,ghostCardStyle:{leaving:!1,pos:{x:0,y:0},width:0,cursorDistance:{x:0,y:0},percentDistanceMiddle:0,transform:"",transformOrigin:"",velocity:0,rotation:0},cards:[{name:"登陆月球",paneIndex:0},{name:"登陆太阳",paneIndex:0},{name:"踏足山巅",paneIndex:1},{name:"写个管理系统",paneIndex:2}],panes:[{name:"准备做"},{name:"正在做"},{name:"已完成"}],settings:d,settingsExpanded:!1}},methods:{onDragStart(t,s){const e=this.$refs["card-"+s][0],a=e.getBoundingClientRect();document.documentElement.style.cursor="grabbing";const r=parseFloat(getComputedStyle(e).paddingLeft),i=parseFloat(getComputedStyle(e).paddingRight);this.mousePos.x=t.pageX,this.mousePos.y=t.pageY,this.draggedCardIdx=s,this.ghostCardStyle.width=e.clientWidth-r-i,this.ghostCardStyle.cursorDistance.x=t.pageX-a.x,this.ghostCardStyle.cursorDistance.y=t.pageY-a.y,this.setGhostCardStyle(t),this.updateUI(),"center"===this.settings.transformOriginMode?this.ghostCardStyle.transformOrigin="center":this.ghostCardStyle.transformOrigin=`${this.ghostCardStyle.cursorDistance.x}px ${this.ghostCardStyle.cursorDistance.y}px`,this.ghostCardStyle.percentDistanceMiddle=this.ghostCardStyle.cursorDistance.x-e.clientWidth/2,this.ghostCardStyle.percentDistanceMiddle=Math.abs(this.ghostCardStyle.percentDistanceMiddle),this.ghostCardStyle.percentDistanceMiddle/=e.clientWidth/2,this.ghostCardStyle.percentDistanceMiddle=Math.round(100*this.ghostCardStyle.percentDistanceMiddle)/100},onDrag(t){t=t||window.event,-1!==this.draggedCardIdx&&(this.mousePos.x=t.pageX,this.mousePos.y=t.pageY)},updateUI(){const t=this.mousePos.x,s=this.mousePos.y;if(-1===this.draggedCardIdx||this.ghostCardStyle.leaving)return;if(!t&&!s)return this.lastMousePos.x=0,this.lastMousePos.y=0,requestAnimationFrame(this.updateUI);let e;this.findTransformValues(),this.setGhostCardStyle(!0);for(let a=0,r=null;r=this.$refs["pane-"+a];a++){if(r=r[0]?r[0]:r,e=this.checkOverlap({x:t,y:s},r.getBoundingClientRect()),e&&this.paneOverlappedIdx===a)return requestAnimationFrame(this.updateUI);if(e){this.paneOverlappedIdx=a;break}}return e?(this.putCardInPane(),requestAnimationFrame(this.updateUI)):requestAnimationFrame(this.updateUI)},onDragStop(){if(-1===this.draggedCardIdx)return;document.documentElement.style.cursor="default";const t=this.$refs["card-"+this.draggedCardIdx]&&this.$refs["card-"+this.draggedCardIdx][0],s=t.getBoundingClientRect();if(!this.settings.animateEnd)return this.resetValues();setTimeout(()=>{this.resetValues()},100),this.ghostCardStyle.leaving=!0;const e=s.x-this.ghostCardStyle.pos.x,a=s.y-this.ghostCardStyle.pos.y;this.ghostCardStyle.transform=`scale(1) translate(${e}px, ${a}px)`},resetValues(){this.draggedCardIdx=-1,this.paneOverlappedIdx=-1,this.lastMousePos.x=0,this.lastMousePos.y=0,this.ghostCardStyle.x=-1e3,this.ghostCardStyle.y=-1e3,this.ghostCardStyle.width=0,this.ghostCardStyle.cursorDistance.x=0,this.ghostCardStyle.cursorDistance.y=0,this.ghostCardStyle.transform="",this.ghostCardStyle.leaving=!1,this.ghostCardStyle.percentDistanceMiddle=0},checkOverlap(t,s){return!(t.x<s.x||t.x>s.x+s.width)&&!(t.y<s.y||t.y>s.y+s.height)},putCardInPane(){this.cards[this.draggedCardIdx].paneIndex=this.paneOverlappedIdx},setGhostCardStyle(t){const s=this.mousePos.x,e=this.mousePos.y,a=[];t&&a.push(`scale(${this.settings.scale})`),a.push(`rotate(${this.ghostCardStyle.rotation}deg)`),this.ghostCardStyle.transform=a.join(" "),this.ghostCardStyle.pos.x=s-this.ghostCardStyle.cursorDistance.x,this.ghostCardStyle.pos.y=e-this.ghostCardStyle.cursorDistance.y},findTransformValues(){if(this.settings.trelloStyle)return this.ghostCardStyle.rotation="4",this.lastMousePos.x=this.mousePos.x,void(this.lastMousePos.y=this.mousePos.y);const t=this.mousePos.x-this.lastMousePos.x;let s=this.ghostCardStyle.rotation||0;const e=this.settings.rotationOffset.min,a=this.settings.rotationOffset.max,r=(a-e)*(1-this.ghostCardStyle.percentDistanceMiddle),i=this.settings.rotationMitigation;s=s*(1-i)+this.sigmoid(t)*(e+r),Math.abs(s)<.01&&(s=0),this.ghostCardStyle.velocity=t,this.ghostCardStyle.rotation=s,this.lastMousePos.x=this.mousePos.x,this.lastMousePos.y=this.mousePos.y},sigmoid(t){return t/(1+Math.abs(t))},expandSettings(){this.settingsExpanded||(this.settingsExpanded=!0)},wrapSettings(){this.settingsExpanded=!1}},computed:{filledPanes(){const t=this.panes.map(t=>({name:t.name}));for(let s=0;s<this.cards.length;s++){const e=t[this.cards[s].paneIndex];e.cards||(e.cards=[]),e.cards.push({...this.cards[s],index:s})}return t},draggedCard(){return this.cards[this.draggedCardIdx]||{name:""}}}},h=o,l=(e("9f95"),e("2877")),g=Object(l["a"])(h,i,n,!1,null,"4d180968",null),c=g.exports,u={name:"index",components:{Task:c},data(){return{}},methods:{}},p=u,y=Object(l["a"])(p,a,r,!1,null,null,null);s["default"]=y.exports},"9f95":function(t,s,e){"use strict";e("d72f")},d72f:function(t,s,e){}}]);
//# sourceMappingURL=chunk-7ad21030.36674dd7.js.map